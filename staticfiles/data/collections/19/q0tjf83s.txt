The current COVID-19 pandemic and subsequent lockdowns have highlighted the close and delicate relationship between a country's public health and economic health. Macroeconomic models that use preexisting epidemic models to calculate the impacts of a disease outbreak are therefore extremely useful for policymakers seeking to evaluate the best course of action in such a crisis. We develop an SIR model of the COVID-19 pandemic that explicitly considers herd immunity, behavior-dependent transmission rates, remote workers, and indirect externalities of lockdown. This model is presented as an exit time control problem where lockdown ends when the population achieves herd immunity, either naturally or via a vaccine. A social planner prescribes separate levels of lockdown for two separate sections of the adult population: low-risk (ages 20-64) and high-risk (ages 65 and over). These levels are determined via optimization of an objective function which assigns a macroeconomic cost to the level of lockdown and the number of deaths. We find that, by ending lockdowns once herd immunity is reached, high-risk individuals are able to leave lockdown significantly before the arrival of a vaccine without causing large increases in mortality. Moreover, if we incorporate a behavior-dependent transmission rate which represents increased personal caution in response to increased infection levels, both output loss and total mortality are lowered. Lockdown efficacy is further increased when there is less interaction between low- and high-risk individuals, and increased remote work decreases output losses. Overall, our model predicts that a lockdown which ends at the arrival of herd immunity, combined with individual actions to slow virus transmission, can reduce total mortality to one-third of the no-lockdown level, while allowing high-risk individuals to leave lockdown well before vaccine arrival.