PURPOSE: To assess the role of left ventricular overload and cumulated fluid balance in the development weaning-induced pulmonary edema (WIPO). METHODS: Ventilated patients in sinus rhythm with COPD and/or heart failure (ejection fraction ≤ 40%) were studied. Echocardiography was performed immediately before and during a 30-min spontaneous breathing trial (SBT) using a T-tube. Patients who failed were treated according to echocardiography results before undergoing a second SBT. RESULTS: Twelve of 59 patients failed SBT, all of them developing WIPO. Patients who succeeded SBT had lower body weight (− 2.5 kg [− 4.8; − 1] vs. + 0.75 kg [− 2.95; + 5.57]: p = 0.02) and cumulative fluid balance (− 2326 ml [− 3715; + 863] vs. + 143 ml [− 2654; + 4434]: p = 0.007) than those who developed WIPO. SBT-induced central hemodynamic changes were more pronounced in patients who developed WIPO, with higher E wave velocity (122 cm/s [92; 159] vs. 93 cm/s [74; 109]: p = 0.017) and E/A ratio (2.1 [1.2; 3.6] vs. 0.9 [0.8; 1.4]: p = 0.001), and shorter E wave deceleration time (85 ms [72; 125] vs. 147 ms [103; 175]: p = 0.004). After echocardiography-guided treatment, all patients who failed the first SBT were successfully extubated. Fluid balance was then negative (− 2224 ml [− 7056; + 100] vs. + 146 ml [− 2654; + 4434]: p = 0.005). Left ventricular filling pressures were lower (E/E′: 7.3 [5; 10.4] vs. 8.9 [5.9; 13.1]: p = 0.028); SBT-induced increase in E wave velocity (+ 10.6% [− 2.7/ + 18] vs. + 25.6% [+ 12.7/ + 49]: p = 0.037) and of mitral regurgitation area were significantly smaller. CONCLUSION: In high-risk patients, WIPO appears related to overloaded left ventricle associated with excessive fluid balance. SBT-induced central hemodynamic changes monitored by CCE help in guiding therapy for successful weaning. ELECTRONIC SUPPLEMENTARY MATERIAL: The online version of this article (10.1007/s00134-020-06061-y) contains supplementary material, which is available to authorized users.