This paper studies an optimal investing problem for a retiree facing longevity risk and living standard risk. We formulate the investing problem as a portfolio choice problem under a time-varying risk capacity constraint. We derive the optimal investment strategy under the specific condition on model parameters in terms of second-order ordinary differential equations. We demonstrate an endogenous number that measures the expected value to sustain the spending post-retirement. The optimal portfolio is nearly neutral to the stock market movement if the portfolio's value is higher than this number; but, if the portfolio is not worth enough to sustain the retirement spending, the retiree actively invests in the stock market for the higher expected return. Besides, we solve an optimal portfolio choice problem under a leverage constraint and show that the optimal portfolio would lose significantly in stressed markets. This paper shows that the time-varying risk capacity constraint has important implications for asset allocation in retirement.