Background Type 2 diabetes (T2DM) and obesity are significant risks for mortality in Covid19. Metformin has been hypothesized as a treatment for COVID19. Metformin has sex specific immunomodulatory effects which may elucidate treatment mechanisms in COVID-19. In this study we sought to identify whether metformin reduced mortality from Covid19 and if sex specific interactions exist. Methods De-identified claims data from UnitedHealth were used to identify persons with at least 6 months continuous coverage who were hospitalized with Covid-19. Persons in the metformin group had at least 90 days of metformin claims in the 12 months before hospitalization. Unadjusted and multivariate models were conducted to assess risk of mortality based on metformin as a home medication in individuals with T2DM and obesity, controlling for pre-morbid conditions, medications, demographics, and state. Heterogeneity of effect was assessed by sex. Results 6,256 persons were included; 52.8% female; mean age 75 years. Metformin was associated with decreased mortality in women by logistic regression, OR 0.792 (0.640, 0.979); mixed effects OR 0.780 (0.631, 0.965); Cox proportional-hazards: HR 0.785 (0.650, 0.951); and propensity matching, OR of 0.759 (0.601, 0.960). TNF-alpha inhibitors were associated with decreased mortality in the 38 persons taking them, by propensity matching, OR 0.19 (0.0378, 0.983). Conclusions Metformin was significantly associated with reduced mortality in women with obesity or T2DM in observational analyses of claims data from individuals hospitalized with Covid-19. This sex-specific finding is consistent with metformin reducing TNF-alpha in females over males, and suggests that metformin conveys protection in Covid-19 through TNF-alpha effects. Prospective studies are needed to understand mechanism and causality.